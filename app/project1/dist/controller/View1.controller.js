sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageBox","sap/ui/unified/FileUploaderParameter"],function(e,r,a){"use strict";return e.extend("naitik.project1.controller.View1",{onInit:function(){},onOk:function(){var e=this.byId("fileUp");if(e.getValue()){var a=e.oFileUpload.files[0];this.readExcelFileAndUpload(a)}else{r.error("Please select an Excel file")}},readExcelFileAndUpload:function(e){var r=new FileReader;r.onload=function(e){var r=e.target.result;var a=XLSX.read(r,{type:"binary"});var n=a.SheetNames[0];var t=XLSX.utils.sheet_to_json(a.Sheets[n]);var o=t.map(function(e){return{first_name:e.first_name,last_name:e.last_name,email:e.email,gender:e.gender}});console.log("Transformed JSON Data:",o);this.uploadExcelDataToBackend(o)}.bind(this);r.readAsBinaryString(e)},uploadExcelDataToBackend:function(e){var a=this.getView().getModel("mainModel");var n=a.bindList("/kpilist");var t=e.length;var o=0;e.forEach(function(e){n.create(e,{headers:{"Content-Type":"application/json"},success:function(e){console.log("Data uploaded successfully",e);o++;if(o===t){r.success(e.message||"All records uploaded successfully")}},error:function(e){console.error("Error uploading data",e);r.error("Error uploading data")}})});console.log("All records processed")},oncreate:function(){var e=this.getOwnerComponent().getModel("mainModel");var r=e.bindList("/Students");var a=r.create({name:this.byId("name").getValue(),address:this.byId("add").getValue(),mn:this.byId("mn").getValue()})},onSubmit:function(){var e=this.byId("name").getValue();var a=this.byId("add").getValue();var n={ID:1,Name:e,Address:a};var t=this.getOwnerComponent().getModel("mainModel");var o=t.bindList("/tbl2");o.create(n,{success:function(e){console.log("Data sent successfully to service",e);r.success("Data sent successfully to service")},error:function(e){console.error("Error sending data to service",e);r.error("Error sending data to service")}})},showError:function(e){r.error(e)}})});